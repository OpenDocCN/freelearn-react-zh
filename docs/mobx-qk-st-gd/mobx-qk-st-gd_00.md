# 前言

多年来，响应式编程一直吸引着程序员的想象力。自从四人组标准化了观察者设计模式以来，这个术语已经成为每个程序员标准词汇的一部分：

观察者：定义对象之间的一对多依赖关系，以便当一个对象改变状态时，所有依赖者都会被通知并自动更新。-《设计模式》，Erich Gamma，Richard Helm，Ralph Johnson，John Vlissides，1995

尽管如此，有各种各样的技术、库和框架实现了观察者模式。然而，MobX 在应用这种模式到状态管理方面是独一无二的。它有一个非常友好的语法，一个小的核心 API，使初学者很容易学习，并且可以应用在任何 JavaScript 项目中。此外，该库已被证明是可扩展的，不仅在 Mendix 首次应用该项目时，而且在著名项目中，如 Microsoft Outlook，DICE 的战地 1，Jenkins，Coinbase 等等。

这本书不仅会指导您了解基础知识；它还会让您沉浸在 MobX 的哲学中：*任何可以从应用程序状态中派生出来的东西，都应该自动派生出来。*

MobX 并不是第一个这样的库，但它站在巨人的肩膀上，推动了透明响应式编程范例的可能性边界。例如，据作者所知，它是第一个将反应性与同步事务结合起来的主要库，也是第一个明确区分派生值和自动副作用（反应）概念的库。

与许多学习材料不同，本书将指导您了解 MobX 及其许多扩展点的内部工作原理。这本书希望留下一个持久的印象，即一个基本简单（而且非常可读！）的范例可以用来完成非常具有挑战性的任务，不仅在领域复杂性方面，而且在性能方面也是如此。

# 这本书适合谁

状态管理在任何状态在代码库的不同位置相关的应用程序中起着至关重要的作用。这要么是因为有多个数据的使用者或多个数据的生产者。在实践中，这意味着 MobX 在任何具有大量数据输入或数据可视化的应用程序中都是有用的。

MobX 官方支持 React.js、Preact 和 Angular。然而，许多人将该库与 jQuery、konva.js、Next.js、Vue.js 甚至 Backbone 等库和框架结合使用。在阅读本书时，您将发现使用类似 MobX 这样的工具所需的概念在任何环境中都是通用的。

# 本书涵盖内容

第一章，“状态管理简介”，从概念上介绍了*状态管理*及其许多细微之处。它介绍了副作用模型，并为您准备了理解 MobX 所需的哲学。最后，它快速介绍了 MobX 及其一些核心构建模块。

第二章，“可观察对象、操作和反应”，深入探讨了 MobX 的核心构建模块。它向您展示了创建可观察对象的各种方法，使用操作对可观察对象进行变化，并最终使用反应来对可观察对象上发生的任何变化做出反应。这三者构成了 MobX 的核心三部曲。

第三章，“使用 MobX 构建 React 应用”，结合到目前为止所获得的知识，为 React 应用提供动力。它解决了在线商店搜索图书的使用案例。该应用首先通过识别核心可观察状态来构建，使用操作来改变状态，并使用 mobx-react 中的`observer()`实用程序来通过反应。React 组件是观察者，它们对可观察状态的变化做出反应，并自动呈现新状态。本章将让您提前体验 MobX 在 React 应用中进行状态管理的简单性。

第四章，“设计可观察状态树”，着重设计可观察状态，并介绍了 MobX 中的各种选项。我们将解决如何限制 MobX 中的可观察性，并学习如何创建一个仅观察必要内容的紧密可观察状态。除了限制可观察性，我们还将看到如何使用`extendObservable()`扩展可观察性。最后，我们将研究计算属性，并研究使用 ES2015 类来建模可观察状态。

第五章《派生、操作和反应》进一步探讨了 MobX 的核心构建块，并更详细地探索了 API。它还涉及了统治这些构建块的哲学。通过本章结束时，您将巩固对 MobX 的理解和核心直觉。

第六章《处理真实世界的用例》是我们将 MobX 应用于两个重要的真实世界用例的地方：表单处理和页面路由。这两者在本质上都是非常直观的，但我们会认为，当以可观察的状态、操作和反应的形式表示时，它们可以更容易地处理。这种表示使得 React 组件（*观察者*）成为状态的自然视觉扩展。我们还将发展我们对使用 MobX 进行状态建模的核心直觉。

第七章《特殊情况的特殊 API》是对低级别且功能强大但隐藏在顶级 API 阴影中的 API 的调查，例如`observable()`、`action()`、`computed()`和`reaction()`。我们将探索这些低级别的 API，然后简要介绍 MobX 开发人员可用的调试工具。令人欣慰的是，即使在那些罕见的奇怪情况下，MobX 也会全方位地支持您。

第八章《探索 mobx-utils 和 mobx-state-tree》为您提供了一些有用的包的味道，这些包可以简化 MobX 驱动开发中遇到的日常用例。顾名思义，mobx-utils 是一个实用工具包，其中包含各种函数。另一方面是强大的 mobx-state-tree，通常简称为 MST，它规定了一种可扩展的 MobX 应用程序方法，内置了一些模式，一旦您采用了 MST 思维方式，这些模式就会免费提供给您。这是对 MobX 的一个值得的升级，对于严肃的用户来说是必不可少的。

第九章，*MobX 内部*，在这里我们通过剥离层并窥探 MobX 的内部工作方式来达到高潮。核心抽象非常简单和明确定义，它们清晰地分离了责任。如果术语*透明函数式响应式编程*听起来像是一门黑魔法，这一章将揭开魔法，揭示 MobX 如何拥抱它。这一章也是对 MobX 代码库的入门，对于希望成为 MobX 项目核心贡献者的任何人来说都是值得一读的。

# 充分利用本书

MobX 通常用于长期存储在内存中起重要作用的编程环境，尤其是 Web、移动和桌面应用程序。本书需要对 JavaScript 编程语言有基本的了解，并且在示例中将使用现代的`ES2015`语法。前端示例基于 ReactJS 框架，因此对它的一些了解将会有所帮助，但并非必需。

# 下载示例代码文件

您可以从[www.packtpub.com](http://www.packtpub.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了这本书，您可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便文件直接通过电子邮件发送给您。

您可以按照以下步骤下载代码文件：

1.  在[www.packtpub.com](http://www.packtpub.com/support)登录或注册。

1.  选择“支持”选项卡。

1.  单击“代码下载和勘误”。

1.  在搜索框中输入书名，然后按照屏幕上的说明操作。

文件下载完成后，请确保使用最新版本的解压缩软件解压缩文件夹：

+   WinRAR/7-Zip 适用于 Windows

+   Zipeg/iZip/UnRarX 适用于 Mac

+   7-Zip/PeaZip 适用于 Linux

该书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/MobX-Quick-Start-Guide`](https://github.com/PacktPublishing/MobX-Quick-Start-Guide)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还有来自丰富书籍和视频目录的其他代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)上找到。去看看吧！

# 下载彩色图片

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。 您可以在这里下载：[`www.packtpub.com/sites/default/files/downloads/MobXQuickStartGuide_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/MobXQuickStartGuide_ColorImages.pdf)。

# 代码演示

访问以下链接查看代码运行的视频：

[`bit.ly/2NEww85`](http://bit.ly/2NEww85)

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词，数据库表名，文件夹名，文件名，文件扩展名，路径名，虚拟 URL，用户输入和 Twitter 句柄。 例如："将下载的`WebStorm-10*.dmg`磁盘映像文件挂载为系统中的另一个磁盘。"

代码块设置如下：

```jsx
connect(mapStateToProps, mapDispatchToProps, mergeProps, options)(Component)
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：

```jsx
import { observable, autorun, action } from 'mobx';

let cart = observable({
    itemCount: 0,
    modified: new Date(),
});
```

任何命令行输入或输出都以以下形式编写：

```jsx
$ mkdir css
$ cd css
```

**粗体**：表示新术语，重要单词或屏幕上看到的单词。 例如，菜单中的单词或对话框中的单词会以这种形式出现在文本中。 例如："从管理面板中选择系统信息。"

警告或重要说明会出现在这样的形式中。提示和技巧会出现在这样的形式中。
